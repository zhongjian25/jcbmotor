$define(["jquery.qrcode","clipboard","jquery.mediaQuery"],function(r,e,t,i){var n,o;n="undefined"!=typeof global?global:this.window||this.global,o=function(e){"use strict";var s,a,d={event:{addEvent:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent?e.attachEvent("on"+t,i):e["on"+t]=i},removeEvent:function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent?e.detachEvent("on"+t,i):e["on"+t]=null},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}},trim:function(e){return String.prototype.trim?e.trim():e.replace(/^\s+|s+$/g,"")},indexOf:function(e,t){if(!this.isArray(e))throw new Error(e.toString()+" is a non-Array！");if(Array.prototype.indexOf)return e.indexOf(t);for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i},isArray:function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},validate:function(e,t){var i,n=[];if(this.isArray(t))for(var r,o=0;r=t[o++];)this.indexOf(e,r)<0&&n.push(r);else for(i in t)i in e||n.push(i);if(0!==n.length)throw new Error("there is such no property: "+n.join(", "))},getElementTop:function(e){for(var t=e.offsetTop,i=e.offsetParent;null!==i;)t+=i.offsetTop,i=i.offsetParent;return t},getElementLeft:function(e){for(var t=e.offsetLeft,i=e.offsetParent;null!==i;)t+=i.offsetLeft,i=i.offsetParent;return t},handleParameters:function(e){var t="";for(var i in e)t=t+i+"="+encodeURIComponent(e[i])+"&";return t},extend:function(){var e,t,i={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&(i[t]=arguments[e][t]);return i},each:function(e,t){if(e){for(var i,n=0,r=e.length;n<r;n++)i=t.call(e[n],n,e[n]);return i}},getElementByclassN:function(e,t){if(e){var i=[];if(!t&&document.querySelectorAll&&0<(i=document.querySelectorAll(e)).length)return i;var n,r,o=e.split("."),s=o[0]||"*",a=o[1],c=(t||document.body).getElementsByTagName(s),l=this;return this.each(c,function(e,t){1===t.nodeType&&(n=t.className.split(/\s+/g),r=t,l.each(n,function(e,t){t+""===a&&i.push(r)}))}),i}},getmeta:function(e){for(var t,i=document.getElementsByTagName("meta"),n=0;t=i[n++];)if(t.getAttribute("name")&&t.getAttribute("name").toLowerCase()===e)return t.content},getimg:function(){var e=this.convertToArray(document.body.getElementsByTagName("img"));if(0!==e.length)return encodeURIComponent(e[0].src)},getElement:function(e){return"#"===e.charAt(0)?document.getElementById(e):this.getElementByclassN(e)[0]},parseUrl:function(e,n){var t={};for(var i in e)t[i]=e[i].replace(/{{([A-Z]*)}}/g,function(e,t){var i=t.toLowerCase();return n[i]?encodeURIComponent(n[i]):""});return t},isWeixinBrowser:function(){var e=navigator.userAgent.toLowerCase();return!!/micromessenger/.test(e)},convertToArray:function(e){var t=null;try{t=Array.prototype.slice.call(e,0)}catch(r){t=new Array;for(var i=0,n=e.length;i<n;i++)t.push(e[i])}return t},parseClassName:function(e,t){for(var i,n=e.split(/\s+/),r=0;i=n[r++];)if(i in t)return t[i]},getWinDimension:function(){var e=window.innerWidth,t=window.innerHeight;return"number"!=typeof e&&(t="CSS1Compat"===document.compatMode?(e=document.documentElement.clientWidth,document.documentElement.clientHeight):(e=document.body.clientWidth,document.body.clientHeight)),{pageWidth:e,pageHeight:t}},throttle:function(i,n){var r=null;return function(){var e=this,t=arguments;clearTimeout(r),r=setTimeout(function(){i.apply(e,t)},n)}},uniq:function(e){for(var t=[],i=0;i<e.length;i++)-1==t.indexOf(e[i])&&t.push(e[i]);return t},intersect:function(e,t){e=this.uniq(e),t=this.uniq(t);for(var i=[],n=0;n<e.length;n++)for(var r=e[n],o=0;o<t.length;o++)if(t[o]===r){i.push(r);break}return i},loadjs:(s=!1,a=[],function(e,t){var i=document.getElementsByTagName("head")[0],n=document.createElement("script"),r=document.getElementById("loaded"),o=document.dispatchEvent;a.push(t),s?t&&t():(n.setAttribute("type","text/javascript"),n.setAttribute("id","loaded"),n.setAttribute("src",e),n[o?"onload":"onreadystatechange"]=function(){var e;if(!s&&(o||/loaded|complete/i.test(n.readyState)))for(s=!0;e=a.pop();)e()},!r&&i.appendChild(n))})};function u(e,t,i){this.element=e,this.wxbox=document.createElement("div"),this.URL=t,this.settings=i,this.style=i.style,this.bgcolor=i.bgcolor,this.evenType=i.evenType||"mouseover",this.isTitleVisibility=void 0===i.isTitleVisibility||i.isTitleVisibility,this.title=i.title||"分享到微信",this.isTipVisibility=void 0===i.isTipVisibility||i.isTipVisibility,this.tip=i.tip||"“扫一扫” 即可将网页分享到朋友圈。",this.upDownFlag="",this.status=!1,this.visibility=!1,this.qrcode=null}function n(e){var t={title:document.title,url:location.href,host:location.origin||"",description:d.getmeta("description"),image:d.getimg(),sites:["iShare_weibo","iShare_wechat","iShare_moments","iShare_qq","iShare_tencent","iShare_douban","iShare_qzone","iShare_renren","iShare_youdaonote","iShare_copy","iShare_facebook","iShare_linkedin","iShare_twitter","iShare_googleplus","iShare_tumblr","iShare_pinterest"],initialized:!0,isTitle:!0,isAbroad:!1,WXoptions:{qrcodeW:120,qrcodeH:120,qrcodeBgc:"#fff",qrcodeFgc:"#000",bgcolor:"#2BAD13"}},i=e||window.iShare_config;if(!i)throw new Error("container property is required.");if(!i.container)throw new Error("container property is required.");if(!d.getElement(i.container))throw new Error('there is such no className|id: "'+i.container+'".');this.container=d.getElement(i.container);var n=this.container.getAttribute("data-sites"),r=n?n.split(/\s*,\s*/g):null;r&&d.validate(t.sites,r),i.config&&d.validate(t,i.config),i.config.sites&&d.validate(t.sites,i.config.sites),this.wx=null,this.defaults=t,this.dataSites=r?{sites:r}:{},this.config=i.config?i.config:{},void 0===this.config.isAbroad?this.config.sites=d.intersect(this.defaults.sites,this.config.sites):this.config.isAbroad?this.config.sites=d.intersect(this.defaults.sites.slice(10),this.config.sites):this.config.sites=d.intersect(this.defaults.sites.slice(0,10),this.config.sites),this.settings=d.extend(t,this.config,this.dataSites),this.settings.WXoptions=d.extend(t.WXoptions,this.config.WXoptions),this.init()}return u.prototype.qrcode=null,u.prototype={constructor:u,init:function(){this.render(),this.init=this.show,this.bindEvent()},render:function(){var e="",t="",i=this.bgcolor?this.bgcolor:"#ddd",n="";n=d.getWinDimension().pageHeight/2<d.getElementTop(this.element)?(t="",e="display:none;",this.upDownFlag="down","border-bottom-left-radius: 0;"):(t="display:none;",e="",this.upDownFlag="up","border-top-left-radius: 0;");var r='<div style="'+e+"position: relative;height: 0;width: 0;border-style: solid;border-width: 12px;border-color: transparent;border-bottom-color: "+i+';border-top: none;"></div><div style="text-align: center;background-color: '+i+";box-shadow: 1px 1px 4px #888888;padding: 8px 8px 4px;border-radius: 4px;"+n+'">'+(this.isTitleVisibility?'<p class="tt" style="line-height: 30px;margin:0; text-shadow: 1px 1px rgba(0,0,0,0.1);font-weight: 700;margin-bottom: 4px;">'+this.title+"</p>":"")+'<div class="qrcode" style="width:'+this.settings.qrcodeW+"px; height:"+this.settings.qrcodeH+'px; overflow:hidden;"></div>'+(this.isTipVisibility?'<p style="font-size: 12px;line-height: 20px; margin: 4px auto;width: 120px;">'+this.tip+"</p>":"")+'</div><div style="'+t+"position: relative;height: 0;width: 0;border-style: solid;border-width: 12px;border-color: transparent;border-top-color: "+i+';border-bottom: none;"></div>';this.wxbox.innerHTML=r,this.wxbox.style.cssText="position:absolute; left: -99999px; display: none;",document.body.appendChild(this.wxbox)},setLocation:function(e){this.wxbox.offsetWidth,this.wxbox.offsetHeight;var t=this.element.offsetWidth,i=this.element.offsetHeight,n=d.getElementTop(this.element),r="position:absolute; color: #000;z-index: 99999;";r=r+"left: "+(t/2-12+d.getElementLeft(this.element))+"px;",r="down"===this.upDownFlag?r+"top: "+(n-226)+"px;":r+"top: "+(n+i)+"px;",this.wxbox.style.cssText=r+this.style,e&&this.hide()},bindEvent:function(){var i=this;"click"===this.evenType?d.event.addEvent(this.element,"click",function(e){var t=e||window.event;d.event.stopPropagation(t),d.event.preventDefault(t),i.visibility?i.hide():i.show()}):(d.event.addEvent(this.element,"mouseover",function(e){e||window.event,i.show()}),d.event.addEvent(this.element,"mouseout",function(e){e||window.event,i.hide()})),d.event.addEvent(window,"resize",d.throttle(function(){i.status&&i.visibility&&i.setLocation()},200))},startQR:function(){var e=this;return function(){e.qrcode||r(d.getElementByclassN(".qrcode",e.wxbox)[0]).qrcode({text:e.URL,width:e.settings.qrcodeW,height:e.settings.qrcodeH,foreground:e.settings.qrcodeFgc,background:e.settings.qrcodeBgc})}},show:function(){this.status=!0,this.wxbox.style.display="block",this.visibility=!0,this.show=function(){this.wxbox.style.display="block",this.visibility=!0}},hide:function(){this.wxbox.style.display="none",this.visibility=!1},remove:function(){this.wxbox.parentNode.removeChild(this.wxbox)}},n.prototype=function(){var a={iShare_qq:"https://connect.qq.com/widget/shareqq/index.html?url={{URL}}&title={{TITLE}}&desc={{DESCRIPTION}}&summary=&pics={{IMAGE}}",iShare_qzone:"https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={{URL}}&title={{TITLE}}&summary={{DESCRIPTION}}&pics={{IMAGE}}&desc=&site=",iShare_tencent:"https://share.v.t.qq.com/index.php?c=share&a=index&title={{TITLE}}&url={{URL}}&pic={{IMAGE}}",iShare_weibo:"https://service.weibo.com/share/share.php?url={{URL}}&title={{TITLE}}&pic={{IMAGE}}",iShare_wechat:"",iShare_moments:"",iShare_douban:"https://shuo.douban.com/!service/share?href={{URL}}&name={{TITLE}}&text={{DESCRIPTION}}&image={{IMAGE}}",iShare_renren:"https://widget.renren.com/dialog/share?resourceUrl={{URL}}&title={{TITLE}}&pic={{IMAGE}}&description={{DESCRIPTION}}",iShare_youdaonote:"https://note.youdao.com/memory/?title={{TITLE}}&pic={{IMAGE}}&summary={{DESCRIPTION}}&url={{URL}}",iShare_linkedin:"https://www.linkedin.com/shareArticle?mini=true&ro=true&title={{TITLE}}&url={{URL}}&summary={{DESCRIPTION}}&armin=armin",iShare_facebook:"https://www.facebook.com/sharer.php?u={{URL}}&title={{TITLE}}&images={{IMAGE}}&summary={{DESCRIPTION}}",iShare_twitter:"https://twitter.com/intent/tweet?text={{TITLE}}&url={{URL}}",iShare_googleplus:"https://plus.google.com/share?url={{URL}}&t={{TITLE}}",iShare_pinterest:"https://www.pinterest.com/pin/create/button/?url={{URL}}&description={{DESCRIPTION}}&media={{IMAGE}}",iShare_tumblr:"https://www.tumblr.com/widgets/share/tool?shareSource=legacy&canonicalUrl=&url={{URL}}&title={{TITLE}}",iShare_copy:""},s={iShare_qq:"QQ好友",iShare_qzone:"QQ空间",iShare_moments:"朋友圈",iShare_tencent:"腾讯微博",iShare_weibo:"新浪微博",iShare_wechat:"微信",iShare_douban:"豆瓣",iShare_renren:"人人",iShare_youdaonote:"有道笔记",iShare_linkedin:"Linkedin",iShare_facebook:"Facebook",iShare_twitter:"Twitter",iShare_googleplus:"Google+",iShare_pinterest:"Pinterest",iShare_tumblr:"Tumblr",iShare_copy:"复制链接"},c={iShare_qq:'<img alt="QQ好友" class="share-img qq" src="/public/img/share-qq.png">',iShare_qzone:'<img alt="QQ空间" class="share-img qzone" src="/public/img/share-qzone.png">',iShare_moments:'<img alt="朋友圈" class="share-img moments" src="/public/img/share-moments.png">',iShare_tencent:'<i alt="腾讯微博" class="iconfont tencent" style="vertical-align: -2px;">&#xe608;</i>',iShare_weibo:'<img alt="微博" class="share-img weibo" src="/public/img/share-weibo.png">',iShare_wechat:'<img alt="微信" class="share-img wechat" src="/public/img/share-wechat.png">',iShare_douban:'<i alt="豆瓣" class="iconfont douban" style="vertical-align: -2px;">&#xe612;</i>',iShare_renren:'<i alt="人人" class="iconfont renren">&#xe603;</i>',iShare_youdaonote:'<i alt="有道笔记" class="iconfont youdaonote" style="vertical-align: -2px;">&#xe604;</i>',iShare_linkedin:'<img alt="Linkedin" class="share-img linkedin" src="/public/img/share-linkedin.png">',iShare_facebook:'<img alt="Facebook" class="share-img facebook" src="/public/img/share-facebook.png">',iShare_twitter:'<img alt="Twitter" class="share-img twitter" src="/public/img/share-twitter.png">',iShare_googleplus:'<i alt="Google+" class="iconfont googleplus" style="vertical-align: -2px;">&#xe60b;</i>',iShare_pinterest:'<img alt="Pinterest" class="share-img pinterest" src="/public/img/share-pinterest.png">',iShare_tumblr:'<img alt="Tumblr" class="share-img tumblr" src="/public/img/share-tumblr.png">',iShare_copy:'<img alt="复制链接" class="share-img share" src="/public/img/share-copyLink.png">'};function t(e){if(this.container.hasChildNodes())for(var t,i,n=this.container.childNodes,r=0;i=n[r++];)if(1===i.nodeType)if(t=d.parseClassName(i.className,d.parseUrl(a,this.settings)),-1<i.className.indexOf("iShare_wechat"))i.href="javascript:void(0);","PC"===e||"PAD"===e?this.wx=new u(i,this.settings.url,this.settings.WXoptions):i=h(i);else if(-1<i.className.indexOf("iShare_moments"))i.href="javascript:void(0);",i=h(i);else if(-1<i.className.indexOf("iShare_copy")){i.href="javascript:void(0);",i.className=i.className+" clipboard-copy",i.setAttribute("data-clipboard-text",window.location.href);var o=new ClipboardJS(".clipboard-copy");o.on("success",function(e){alert("复制链接成功"),e.clearSelection()}),o.on("error",function(e){alert("当前浏览器不支持此功能，请手动复制。")})}else t&&(i.href=t),i.target="_blank"}function l(e,t,i,n){var r=document.createElement("a");if(r.className=t,r.innerHTML=c[t],this.settings.isTitle&&(r.title=s[t]),"isWechat"===i)r.href="javascript:void(0);","PC"===n||"PAD"===n?this.wx=new u(r,e,this.settings.WXoptions):r=h(r);else if("isMoments"===i)r.href="javascript:void(0);",r=h(r);else if("isCopy"===i){r.href="javascript:void(0);",r.className=r.className+" clipboard-copy",r.setAttribute("data-clipboard-text",window.location.href);var o=new ClipboardJS(".clipboard-copy");o.on("success",function(e){alert("复制链接成功"),e.clearSelection()}),o.on("error",function(e){alert("当前浏览器不支持此功能，请手动复制。")})}else r.href=e,r.target="_blank";return r}function h(i){var n;return n=d.isWeixinBrowser()?"/public/img/share-bwechat.png":"/public/img/share-browser.png",i.addEventListener("click",function(e){if("IMG"!==e.target.tagName||"-1"!=e.target.className.indexOf("share-img")){var t=document.createElement("img");t.src=n,t.setAttribute("style","position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: 99999;"),t.addEventListener("click",function(){t.parentNode.removeChild(t)}),i.appendChild(t)}}),i}function i(i){var n,r=document.createDocumentFragment(),o=d.parseUrl(a,this.settings),s=this;d.each(s.settings.sites,function(e,t){"iShare_wechat"===t?n=l.call(s,s.settings.url,t,"isWechat",i):"iShare_copy"===t?n=l.call(s,s.settings.url,t,"isCopy"):"iShare_moments"===t&&"MO"===i?n=l.call(s,s.settings.url,t,"isMoments"):"iShare_moments"!==t&&(n=l.call(s,o[t],t)),r.appendChild(n)}),this.container.innerHTML="",this.container.appendChild(r)}return{constructor:n,init:function(){var e=this;r.mediaQuery({callback1024:function(){e.wx&&(e.wx.remove(),e.wx=null),e.settings.initialized?i.call(e,"PC"):t.call(e,"PC"),e.wx&&(e.bindEvent(),e.wx.init(),e.wx.startQR()())},callback7681024:function(){e.wx&&(e.wx.remove(),e.wx=null),e.settings.initialized?i.call(e,"PAD"):t.call(e,"PAD"),e.wx&&(e.bindEvent(),e.wx.init(),e.wx.startQR()())},callback768:function(){e.wx&&(e.wx.remove(),e.wx=null),e.settings.initialized?i.call(e,"MO"):t.call(e,"MO")}})},bindEvent:function(){var e=this;d.event.addEvent(this.container,"mouseover",function t(){e.wx.setLocation(!0),d.event.removeEvent(e.container,"mouseover",t)})}}}(),window.iShare_config?new n:n},"function"==typeof define&&define.amd?define([],o()):"object"==typeof exports?module.exports=o():n.iShare=o()});